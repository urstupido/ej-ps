<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.2.dtd">
<queryservice>
	<queries>
		<query id="findProductDistributionList" isDynamic="true">
			<statement>
				SELECT rownum as no,
					   cont_no,
					   prod_no,
					   seq,
					   p.prod_name,
					   p.max_ivt_rto,
					   dstr_rto,
					   dstr_rto_reg_dt,
					   last_chng_usid,
					   last_chng_dt
				FROM prod_dstr_rto d, prod_base p
				WHERE d.prod_no = p.prod_no
				  and d.del_yn = 'N'
				  #if ($vo.contNo)
				  and d.cont_no = :vo.contNo
				  #end
			</statement>
		</query>
		
		
		<query id="updateProductDistribution">
			<statement>
				UPDATE prod_dstr_rto
				SET last_chng_dt = sysdate,
					del_yn = 'Y'
				WHERE prod_no = :vo.prodNo
				and cont_no = :vo.contNo
				and seq = :vo.seq
			</statement>
		</query>
		
		<query id="createProductDistribution">
			<statement>
				INSERT INTO prod_dstr_rto (cont_no, prod_no, seq, dstr_rto, dstr_rto_reg_dt, last_chng_usid, last_chng_dt, del_yn)
				VALUES (:vo.contNo, :vo.prodNo, lpad(convert(convert(:vo.seq, SQL_INTEGER)+1, SQL_VARCHAR),3,'0'), :vo.dstrRto, :vo.dstrRtoRegDt, 'test', sysdate, 'N')
			</statement>
		</query>
		
	</queries>
</queryservice>