<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.2.dtd">
<queryservice>
	<queries>
		<query id="findProductList" isDynamic="true">
			<statement>
				<!--foundation findMovieList-START-->
				SELECT rownum as no, 
					   p.prod_no, 
					   p.prod_name,
					   c1.code_name as prodLclsC,
					   c2.code_name as astsMngOrgC, 
					   c3.code_name as prodOffrOrgC,
					   p.prod_sell_entr_dt,
					   p.prod_sell_end_dt
				FROM prod_base p, code c1, code c2, code c3 
				WHERE 1=1
				  and p.prod_lcls_c = c1.code
				  and c1.code_type = 'PROD_LCLS_C'
				  and p.asts_mng_org_c = c2.code 
				  and p.prod_offr_org_c = c3.code
				  #if ($vo.prodNo != "")
				  	and p.prod_no like '%' || :vo.prodNo || '%'
				  #end 
				  #if ($vo.prodName != "")
				  	and p.prod_name like '%' || :vo.prodName || '%'
				  #end
				  #if ($vo.prodLclC != "")
				  	and c1.code like '%' || :vo.prodLclsC || '%'
				  #end 
			</statement>
		</query>
		
		<query id="findCustomerList">
			<statement>
				SELECT custom.cus_no, c.code_name, custom.rbno,
				custom.cnm, custom.psno, custom.addr, custom.dong_blw_addr,
				custom.last_chng_usid, custom.last_chng_dt, rownum as no
				FROM custom,
				code c
				where c.code_type='USER_TC' and c.code = custom.user_tc
				AND cus_no like '%' || :vo.cusNo || '%'
				AND cnm like '%' || :vo.cnm || '%'
				and user_tc like '%' || :vo.codeInfo.code || '%'
			</statement>
			<result class="com.sds.ps.domain.Customer">
				<result-mapping column="{code_name}" attribute="{codeInfo.codeName}" />
			</result>
		</query>
		
		<query id="findProductByPk">
			<statement>
				SELECT prod_no, 
					   prod_name,
					   prod_lcls_c,
					   prod_mcls_c,
					   prod_scls_c,					   
					   prod_sell_entr_dt,
					   prod_sell_end_dt,
					   asts_mng_org_c, 
					   prod_offr_org_c,
					   last_chng_usid,
					   last_chng_dt
				FROM prod_base 
				WHERE 1=1
				  and prod_no = :vo.prodNo
			</statement>
			<result class="com.sds.ps.domain.Product" />
		</query>	
		
		
		<query id="updateProduct">
			<statement>
				UPDATE prod_base
				SET prod_name = :vo.prodName,
					prod_lcls_c = :vo.prodLclsC,
					prod_mcls_c = :vo.prodMclsC,
					prod_scls_c = :vo.prodSclsC,					   
					prod_sell_entr_dt = :vo.prodSellEntrDt,
					prod_sell_end_dt = :vo.prodSellEndDt,
					asts_mng_org_c = :vo.astsMngOrgC, 
					prod_offr_org_c = :vo.prodOffrOrgC,
					last_chng_usid = :vo.lastChngUsid,
					last_chng_dt = sysdate
				WHERE prod_no = :vo.prodNo
			</statement>
		</query>
		
		<query id="createCustomer">
			<statement>
				INSERT INTO prod_base (cus_no, user_tc, rbno, cnm, psno, addr, dong_blw_addr, last_chng_usid, last_chng_dt)
				VALUES (:vo.cusNo, :vo.codeInfo.code, :vo.rbno, :vo.cnm, :vo.psno, :vo.addr, :vo.dongBlwAddr, :vo.lastChngUsid, sysdate)
			</statement>
		</query>
		
	</queries>
</queryservice>