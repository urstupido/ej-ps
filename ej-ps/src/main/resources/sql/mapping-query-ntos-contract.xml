<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.2.dtd">
<queryservice>
	<queries>
		<query id="findContractList" isDynamic="true">
			<statement>
				SELECT
				cb.cont_no,
				rownum as no,
				ct.cnm || '('||cb.cus_no||')' as cont_name_no,
				cd2.code_name as plan_code,
				cd1.code_name as cont_proc,
				ct.cnm as
				cus_name,
				cb.plan_entr_date,
				cd3.code_name as rsnd_acc_bnk_c

				FROM cont_base cb,
				custom ct, code cd1, code cd2, code cd3
				WHERE 1=1
				and
				cb.cus_no = ct.cus_no
				and cb.cont_proc_stat_c = cd1.code
				and
				cb.plan_kind_c = cd2.code
				and cd1.code_type='CONT_PROC_STAT_C'
				and
				cd2.code_type='PLAN_KIND_C'
				and cb.rsnd_acc_bnk_c = cd3.code
				and
				cd3.code_type='BNK_C'


				#if ($vo.searchCondition=="1")
				and cb.cont_no like '%' || :vo.searchKeyword || '%'
				#end
				#if
				($vo.searchCondition=="2")
				and ct.cnm like '%' || :vo.searchKeyword || '%'
				#end
			</statement>
			<result class="com.sds.ps.domain.Contract" />
		</query>

		<query id="findContractByPk">
			<statement>
				SELECT cont_no,
				ct.cnm || ' ('||cb.cus_no||')' as
				cont_name_no,
				cd2.code_name as plan_code,
				cd1.code_name as cont_proc,
				cus_no,
				plan_kind_c,
				plan_entr_date,
				cont_proc_stat_c,
				plan_end_date,
				rsnd_acc_bnk_c,
				rsnd_acc_no,
				rsnd_acc_depo_nm,
				last_chng_usid,
				last_chng_dt
				FROM cont_base cb, custom ct, code cd1,
				code cd2
				WHERE 1=1
				and cb.cus_no = ct.cus_no
				and cb.cont_proc_stat_c = cd1.code
				and
				cb.plan_kind_c = cd2.code
				and cd1.code_type='CONT_PROC_STAT_C'
				and
				cd2.code_type='PLAN_KIND_C'
				and cont_no = :vo.contNo
			</statement>
			<result class="com.sds.ps.domain.Contract" />
		</query>

		<query id="createContract">
			<statement>
				INSERT INTO cont_base
				(cont_no, cus_no, plan_kind_c, plan_entr_date, cont_proc_stat_c,
				plan_end_date, rsnd_acc_bnk, rsnd_acc_no, rsnd_acc_depo_nm,
				last_chng_usid, last_chng_dt)
				VALUES (:vo.cont_no, :vo.cus_no,
				:vo.plan_kind_c, :vo.plan_entr_date, :vo.cont_proc_stat_c,
				:vo.plan_end_date, :vo.rsnd_acc_bnk,
				:vo.rsnd_acc_no, :vo.rsnd_acc_depo_nm, :vo.last_chng_usid, sysdate)
			</statement>
		</query>



		<!-- <query id="updateContract"> <statement> UPDATE prod_base SET prod_name 
			= :vo.prodName, prod_lcls_c = :vo.prodLclsC, prod_mcls_c = :vo.prodMclsC, 
			prod_scls_c = :vo.prodSclsC, prod_sell_entr_dt = :vo.prodSellEntrDt, prod_sell_end_dt 
			= :vo.prodSellEndDt, asts_mng_org_c = :vo.astsMngOrgC, prod_offr_org_c = 
			:vo.prodOffrOrgC, last_chng_usid = :vo.lastChngUsid, last_chng_dt = sysdate 
			WHERE prod_no = :vo.prodNo </statement> </query> -->

	</queries>
</queryservice>
