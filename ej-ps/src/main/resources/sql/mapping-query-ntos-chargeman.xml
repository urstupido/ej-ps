<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.2.dtd">
<queryservice>
	<queries>
		<query id="findChargemanList">
			<statement>
			SELECT rownum as no,
				   cont_no,
				   chmn_seq,
				   chmn_nm,
				   chmn_dpnm,
				   chmn_psnm
			FROM chmn_istm
			</statement>
			<result class="com.sds.ps.domain.Chargeman"/>
		</query>

		<query id="findChargemanByPk">
			<statement>
				SELECT cont_no,
					   chmn_seq,
					   chmn_nm,
					   chmn_rrno,
					   chmn_dpnm,
					   chmn_psnm,
					   chmn_mnph,
					   chmn_email,
					   last_chng_usid,
					   last_chng_dt
				FROM chmn_istm
				WHERE 1=1
				  and cont_no = :vo.contNo
				  and chmn_seq = :vo.chmnSeq
			</statement>
			<result class="com.sds.ps.domain.Chargeman" />
		</query>
		
		<query id="updateChargeman">
			<statement>
				UPDATE chmn_istm
				SET chmn_dpnm = :vo.chmnDpnm,
				    chmn_psnm = :vo.chmnPsnm,
				    chmn_mnph = :vo.chmnMnph,
				    chmn_email = :vo.chmnEmail,
					last_chng_usid = :vo.lastChngUsid,
					last_chng_dt = sysdate
				WHERE cont_no = :vo.contNo
				  and chmn_seq = :vo.chmnSeq
			</statement>
		</query>	
		
		<query id="createChargeman">
			<statement>
				INSERT INTO chmn_istm(cont_no, chmn_seq, chmn_nm, chmn_rrno, chmn_dpnm, chmn_psnm, chmn_mnph, 
									  chmn_email, last_chng_usid, last_chng_dt)
				VALUES (:vo.contNo, (select lpad(CAST(max(chmn_seq) as integer)+1, 3, '0') from chmn_istm where cont_no = :vo.contNo), 
						:vo.chmnNm, :vo.chmnRrno, :vo.chmnDpnm, :vo.chmnPsnm, :vo.chmnMnph, :vo.chmnEmail, :vo.lastChngUsid, sysdate)
			</statement>
		</query>
	</queries>
</queryservice>